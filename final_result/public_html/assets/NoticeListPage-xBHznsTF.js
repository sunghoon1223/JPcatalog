import{j as e}from"./ui-vendor-D7YrltUJ.js";import{r as n,c as _}from"./react-vendor-XbLGo5ol.js";import{A as b}from"./AdminLayout-IQvitp-J.js";import{c as f,o as d,q,u as A,x as w,w as h,L as S,e as x,C as M,a as Q,I as K,j as U,B as $,y as G,z as J,F as O,H as R}from"./index-iJ4ZFglL.js";import{S as W,a as X,b as Y,c as Z,d as u}from"./select-Dd79ptlA.js";import"./message-square-wSPTWZHd.js";import"./users-NOTXd2iJ.js";import"./index-BdQq_4o_.js";/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ee=f("EllipsisVertical",[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"12",cy:"5",r:"1",key:"gxeob9"}],["circle",{cx:"12",cy:"19",r:"1",key:"lyex9k"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const te=f("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ae=f("SquarePen",[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a1 1 0 0 1 3 3l-9.013 9.014a2 2 0 0 1-.853.505l-2.873.84a.5.5 0 0 1-.62-.62l.84-2.873a2 2 0 0 1 .506-.852z",key:"ohrbg2"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const se=f("Trash",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}]]),P=n.forwardRef(({className:s,...i},l)=>e.jsx("div",{className:"relative w-full overflow-auto",children:e.jsx("table",{ref:l,className:d("w-full caption-bottom text-sm",s),...i})}));P.displayName="Table";const L=n.forwardRef(({className:s,...i},l)=>e.jsx("thead",{ref:l,className:d("[&_tr]:border-b",s),...i}));L.displayName="TableHeader";const E=n.forwardRef(({className:s,...i},l)=>e.jsx("tbody",{ref:l,className:d("[&_tr:last-child]:border-0",s),...i}));E.displayName="TableBody";const ie=n.forwardRef(({className:s,...i},l)=>e.jsx("tfoot",{ref:l,className:d("border-t bg-muted/50 font-medium [&>tr]:last:border-b-0",s),...i}));ie.displayName="TableFooter";const j=n.forwardRef(({className:s,...i},l)=>e.jsx("tr",{ref:l,className:d("border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted",s),...i}));j.displayName="TableRow";const m=n.forwardRef(({className:s,...i},l)=>e.jsx("th",{ref:l,className:d("h-12 px-4 text-left align-middle font-medium text-muted-foreground [&:has([role=checkbox])]:pr-0",s),...i}));m.displayName="TableHead";const o=n.forwardRef(({className:s,...i},l)=>e.jsx("td",{ref:l,className:d("p-4 align-middle [&:has([role=checkbox])]:pr-0",s),...i}));o.displayName="TableCell";const le=n.forwardRef(({className:s,...i},l)=>e.jsx("caption",{ref:l,className:d("mt-4 text-sm text-muted-foreground",s),...i}));le.displayName="TableCaption";function ue(){const s=_(),{user:i,loading:l}=q(),{t,language:F}=A(),[v,D]=n.useState([]),[C,k]=n.useState(!0),[N,H]=n.useState(""),[p,V]=n.useState("all"),[r,y]=n.useState({page:1,limit:20,total:0}),z={공지:"notice",이벤트:"event",업데이트:"update",일반:"general",general:"general"},g=n.useCallback(async()=>{if(!(l||!i)){k(!0);try{const a=await w.getNotices({search:N||void 0,category:p==="all"?void 0:p,page:r.page,limit:r.limit});D(a.notices),y(c=>{var T;return{...c,total:((T=a.pagination)==null?void 0:T.total)??a.notices.length}})}catch(a){console.error("Failed to fetch notices:",a),h.error(t("admin.notice.list.toast.fetchError"))}finally{k(!1)}}},[l,i,N,p,r.page,r.limit]);n.useEffect(()=>{g()},[g]);const B=async a=>{if(confirm(t("admin.notice.list.confirm.delete")))try{await w.deleteNotice(a),h.success(t("admin.notice.list.toast.deleteSuccess")),g()}catch(c){console.error("Failed to delete notice:",c),h.error(t("admin.notice.list.toast.deleteError"))}},I=async a=>{try{await w.toggleNoticePin(a),h.success(t("admin.notice.list.toast.pinSuccess")),g()}catch(c){console.error("Failed to toggle pin:",c),h.error(t("admin.notice.list.toast.pinError"))}};return l&&C?e.jsx(b,{children:e.jsx("div",{className:"flex items-center justify-center min-h-[400px]",children:e.jsx(S,{className:"h-8 w-8 animate-spin text-blue-600"})})}):i?e.jsx(b,{children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-slate-900",children:t("admin.notice.list.title")}),e.jsx("p",{className:"text-slate-600 mt-1",children:t("admin.notice.list.subtitle")})]}),e.jsxs(x,{onClick:()=>s("/admin/notices/create"),children:[e.jsx(te,{className:"mr-2 h-4 w-4"}),t("admin.notice.list.cta")]})]}),e.jsx(M,{children:e.jsx(Q,{className:"pt-6",children:e.jsxs("div",{className:"flex gap-4",children:[e.jsx("div",{className:"flex-1",children:e.jsx(K,{placeholder:t("admin.notice.list.searchPlaceholder"),value:N,onChange:a=>H(a.target.value)})}),e.jsxs(W,{value:p,onValueChange:V,children:[e.jsx(X,{className:"w-48",children:e.jsx(Y,{})}),e.jsxs(Z,{children:[e.jsx(u,{value:"all",children:t("admin.notice.list.filter.all")}),e.jsx(u,{value:"공지",children:t("admin.notice.list.filter.notice")}),e.jsx(u,{value:"이벤트",children:t("admin.notice.list.filter.event")}),e.jsx(u,{value:"업데이트",children:t("admin.notice.list.filter.update")}),e.jsx(u,{value:"general",children:t("admin.notice.list.filter.general")})]})]})]})})}),e.jsx(M,{children:e.jsxs(P,{children:[e.jsx(L,{children:e.jsxs(j,{children:[e.jsx(m,{className:"w-16",children:t("admin.notice.list.table.pin")}),e.jsx(m,{children:t("admin.notice.list.table.title")}),e.jsx(m,{className:"w-32",children:t("admin.notice.list.table.category")}),e.jsx(m,{className:"w-32",children:t("admin.notice.list.table.author")}),e.jsx(m,{className:"w-24",children:t("admin.notice.list.table.views")}),e.jsx(m,{className:"w-40",children:t("admin.notice.list.table.created")}),e.jsx(m,{className:"w-32 text-right",children:t("admin.notice.list.table.actions")})]})}),e.jsx(E,{children:C?e.jsx(j,{children:e.jsx(o,{colSpan:7,className:"text-center py-8",children:e.jsx(S,{className:"h-6 w-6 animate-spin mx-auto text-blue-600"})})}):v.length===0?e.jsx(j,{children:e.jsx(o,{colSpan:7,className:"text-center py-8 text-muted-foreground",children:t("admin.notice.list.empty")})}):v.map(a=>e.jsxs(j,{children:[e.jsx(o,{children:e.jsx(x,{variant:"ghost",size:"icon",onClick:()=>I(a.id),children:e.jsx(U,{className:d("h-4 w-4",(a.is_pinned||a.isPinned)&&"fill-yellow-500 text-yellow-500")})})}),e.jsx(o,{className:"font-medium",children:a.title}),e.jsx(o,{children:e.jsx($,{variant:"outline",children:(()=>{const c=z[a.category];return c==="notice"?t("admin.notice.list.filter.notice"):c==="event"?t("admin.notice.list.filter.event"):c==="update"?t("admin.notice.list.filter.update"):c==="general"?t("admin.notice.list.filter.general"):a.category})()})}),e.jsx(o,{children:a.author}),e.jsx(o,{children:a.views||0}),e.jsx(o,{className:"text-sm text-muted-foreground",children:new Date(a.created_at).toLocaleDateString(F==="en"?"en-US":"ko-KR")}),e.jsx(o,{className:"text-right",children:e.jsxs(G,{children:[e.jsx(J,{asChild:!0,children:e.jsx(x,{variant:"ghost",size:"icon",children:e.jsx(ee,{className:"h-4 w-4"})})}),e.jsxs(O,{align:"end",children:[e.jsxs(R,{onClick:()=>s(`/admin/notices/edit/${a.id}`),children:[e.jsx(ae,{className:"mr-2 h-4 w-4"}),"수정"]}),e.jsxs(R,{onClick:()=>B(a.id),className:"text-red-600 focus:text-red-600",children:[e.jsx(se,{className:"mr-2 h-4 w-4"}),"삭제"]})]})]})})]},a.id))})]})}),r.total>r.limit&&e.jsxs("div",{className:"flex justify-center gap-2",children:[e.jsx(x,{variant:"outline",disabled:r.page===1,onClick:()=>y(a=>({...a,page:a.page-1})),children:"이전"}),e.jsxs("span",{className:"flex items-center px-4",children:[r.page," / ",Math.ceil(r.total/r.limit)]}),e.jsx(x,{variant:"outline",disabled:r.page>=Math.ceil(r.total/r.limit),onClick:()=>y(a=>({...a,page:a.page+1})),children:"다음"})]})]})}):e.jsx(b,{children:e.jsxs("div",{className:"flex flex-col items-center justify-center min-h-[400px] space-y-4",children:[e.jsx("h2",{className:"text-xl font-semibold",children:t("admin.notice.guard.title")}),e.jsx("p",{className:"text-muted-foreground",children:t("admin.notice.guard.body")}),e.jsx(x,{onClick:()=>s("/admin/login"),children:t("admin.notice.guard.cta")})]})})}export{ue as default};
