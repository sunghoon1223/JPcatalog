import{j as e}from"./ui-vendor-CPG2pbg2.js";import{u as Y,L as P,f as z,h as A,r as D}from"./react-vendor-CUUEtbzt.js";import{C as L,d as T,a as I,f as b,k as C,I as E,h as k,a1 as F,B as U,a2 as $,af as V,ag as q,ah as B,ai as W,a7 as X}from"./index-CSp23eor.js";import{S as G}from"./square-pen-w9ZVmRCc.js";import{H as J}from"./heart-Dzr2dPZn.js";import{t as o,c as K,g as R,a as Q,e as Z,m as O,b as S,k as ee}from"./ko-BhTk4Nb5.js";function _(s,t){const a=o(s),i=o(t),n=a.getTime()-i.getTime();return n<0?-1:n>0?1:n}function se(s){return K(s,Date.now())}function te(s,t){const a=o(s),i=o(t),n=a.getFullYear()-i.getFullYear(),f=a.getMonth()-i.getMonth();return n*12+f}function ae(s){return t=>{const i=(s?Math[s]:Math.trunc)(t);return i===0?0:i}}function ne(s,t){return+o(s)-+o(t)}function re(s){const t=o(s);return t.setHours(23,59,59,999),t}function ce(s){const t=o(s),a=t.getMonth();return t.setFullYear(t.getFullYear(),a+1,0),t.setHours(23,59,59,999),t}function ie(s){const t=o(s);return+re(t)==+ce(t)}function le(s,t){const a=o(s),i=o(t),n=_(a,i),f=Math.abs(te(a,i));let m;if(f<1)m=0;else{a.getMonth()===1&&a.getDate()>27&&a.setDate(30),a.setMonth(a.getMonth()-n*f);let r=_(a,i)===-n;ie(o(s))&&f===1&&_(s,i)===1&&(r=!1),m=n*(f-Number(r))}return m===0?0:m}function oe(s,t,a){const i=ne(s,t)/1e3;return ae(a==null?void 0:a.roundingMethod)(i)}function de(s,t,a){const i=Q(),n=(a==null?void 0:a.locale)??i.locale??Z,f=2520,m=_(s,t);if(isNaN(m))throw new RangeError("Invalid time value");const r=Object.assign({},a,{addSuffix:a==null?void 0:a.addSuffix,comparison:m});let j,v;m>0?(j=o(t),v=o(s)):(j=o(s),v=o(t));const u=oe(v,j),w=(R(v)-R(j))/1e3,l=Math.round((u-w)/60);let x;if(l<2)return a!=null&&a.includeSeconds?u<5?n.formatDistance("lessThanXSeconds",5,r):u<10?n.formatDistance("lessThanXSeconds",10,r):u<20?n.formatDistance("lessThanXSeconds",20,r):u<40?n.formatDistance("halfAMinute",0,r):u<60?n.formatDistance("lessThanXMinutes",1,r):n.formatDistance("xMinutes",1,r):l===0?n.formatDistance("lessThanXMinutes",1,r):n.formatDistance("xMinutes",l,r);if(l<45)return n.formatDistance("xMinutes",l,r);if(l<90)return n.formatDistance("aboutXHours",1,r);if(l<O){const d=Math.round(l/60);return n.formatDistance("aboutXHours",d,r)}else{if(l<f)return n.formatDistance("xDays",1,r);if(l<S){const d=Math.round(l/O);return n.formatDistance("xDays",d,r)}else if(l<S*2)return x=Math.round(l/S),n.formatDistance("aboutXMonths",x,r)}if(x=le(v,j),x<12){const d=Math.round(l/S);return n.formatDistance("xMonths",d,r)}else{const d=x%12,g=Math.trunc(x/12);return d<3?n.formatDistance("aboutXYears",g,r):d<9?n.formatDistance("overXYears",g,r):n.formatDistance("almostXYears",g+1,r)}}function me(s,t){return de(s,se(s),t)}function ue({board:s,posts:t,totalCount:a,currentPage:i,loading:n,searchQuery:f="",onSearch:m,onPageChange:r}){const j=Y(),u=Math.ceil(a/20),w=c=>{c.preventDefault();const y=c.target.querySelector("input");m==null||m(y.value)},l=()=>{j(`/board/${s.slug}/write`)},x=c=>me(new Date(c),{addSuffix:!0,locale:ee}),d=c=>{switch(c){case"notice":return"공지";case"pinned":return"고정";default:return null}},g=c=>{switch(c){case"notice":return"destructive";case"pinned":return"secondary";default:return"outline"}};return n?e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("div",{className:"h-8 w-48 bg-gray-200 rounded animate-pulse"}),e.jsx("div",{className:"h-10 w-24 bg-gray-200 rounded animate-pulse"})]}),e.jsx("div",{className:"h-10 w-full bg-gray-200 rounded animate-pulse"}),[...Array(10)].map((c,N)=>e.jsxs(L,{className:"animate-pulse",children:[e.jsxs(T,{className:"pb-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"h-5 w-12 bg-gray-200 rounded"}),e.jsx("div",{className:"h-6 w-64 bg-gray-200 rounded"})]}),e.jsx("div",{className:"h-4 w-full bg-gray-200 rounded"})]}),e.jsx(I,{className:"pt-0",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("div",{className:"h-4 w-32 bg-gray-200 rounded"}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"h-4 w-12 bg-gray-200 rounded"}),e.jsx("div",{className:"h-4 w-12 bg-gray-200 rounded"}),e.jsx("div",{className:"h-4 w-12 bg-gray-200 rounded"})]})]})})]},N))]}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:s.name}),e.jsx("p",{className:"text-gray-600 mt-1",children:s.description})]}),e.jsxs(b,{onClick:l,className:"flex items-center gap-2",children:[e.jsx(G,{className:"h-4 w-4"}),"글쓰기"]})]}),e.jsxs("form",{onSubmit:w,className:"flex gap-2",children:[e.jsxs("div",{className:"relative flex-1",children:[e.jsx(C,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),e.jsx(E,{type:"text",placeholder:"게시글 검색...",defaultValue:f,className:"pl-10"})]}),e.jsx(b,{type:"submit",variant:"outline",children:"검색"})]}),e.jsxs("div",{className:"flex items-center justify-between text-sm text-gray-600",children:[e.jsxs("span",{children:["총 ",a,"개의 게시글"]}),e.jsxs("span",{children:[i," / ",u," 페이지"]})]}),e.jsx("div",{className:"space-y-2",children:t.length===0?e.jsxs("div",{className:"text-center py-12",children:[e.jsx(k,{className:"mx-auto h-12 w-12 text-gray-400"}),e.jsx("h3",{className:"mt-4 text-lg font-semibold text-gray-900",children:"게시글이 없습니다"}),e.jsx("p",{className:"mt-2 text-gray-600",children:f?"검색 결과가 없습니다.":"첫 번째 게시글을 작성해보세요."})]}):t.map(c=>{var N;return e.jsx(P,{to:`/board/${s.slug}/${c.id}`,children:e.jsxs(L,{className:"transition-all duration-200 hover:shadow-md hover:bg-gray-50 cursor-pointer",children:[e.jsxs(T,{className:"pb-3",children:[e.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[c.is_pinned&&e.jsx(F,{className:"h-4 w-4 text-red-500"}),d(c.post_type)&&e.jsx(U,{variant:g(c.post_type),className:"text-xs",children:d(c.post_type)}),e.jsx("h3",{className:"font-semibold text-gray-900 hover:text-blue-600 transition-colors flex-1",children:c.title})]}),c.excerpt&&e.jsx("p",{className:"text-sm text-gray-600 line-clamp-2",children:c.excerpt})]}),e.jsx(I,{className:"pt-0",children:e.jsxs("div",{className:"flex items-center justify-between text-xs text-gray-500",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("span",{children:c.user_id?"회원":c.author_name||"익명"}),e.jsx("span",{children:x(c.created_at)})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx($,{className:"h-3 w-3"}),e.jsx("span",{children:c.views})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(k,{className:"h-3 w-3"}),e.jsx("span",{children:((N=c.comments)==null?void 0:N.length)||0})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(J,{className:"h-3 w-3"}),e.jsx("span",{children:c.likes})]})]})]})})]})},c.id)})}),u>1&&e.jsxs("div",{className:"flex items-center justify-center gap-2",children:[e.jsxs(b,{variant:"outline",size:"sm",onClick:()=>r==null?void 0:r(i-1),disabled:i<=1,children:[e.jsx(V,{className:"h-4 w-4"}),"이전"]}),e.jsx("div",{className:"flex items-center gap-1",children:Array.from({length:Math.min(u,10)},(c,N)=>{const y=N+1,M=y===i;return e.jsx(b,{variant:M?"default":"outline",size:"sm",onClick:()=>r==null?void 0:r(y),className:"w-10",children:y},y)})}),e.jsxs(b,{variant:"outline",size:"sm",onClick:()=>r==null?void 0:r(i+1),disabled:i>=u,children:["다음",e.jsx(q,{className:"h-4 w-4"})]})]})]})}function pe(){const{boardSlug:s}=z(),[t,a]=A(),i=Y(),[n,f]=D.useState(null),[m,r]=D.useState([]),[j,v]=D.useState(0),[u,w]=D.useState(!0),[l,x]=D.useState(null),d=parseInt(t.get("page")||"1",10),g=t.get("search")||"";D.useEffect(()=>{c()},[s,d,g]);const c=async()=>{if(!s){x("게시판을 찾을 수 없습니다."),w(!1);return}try{w(!0),x(null);const h=await B.getBoard(s);if(!h){x("게시판을 찾을 수 없습니다.");return}f(h);const{posts:p,totalCount:H}=await B.getPosts(s,d,20,g||void 0);r(p),v(H)}catch(h){console.error("Board data loading error:",h),x(h.message||"데이터를 불러오는데 실패했습니다.")}finally{w(!1)}},N=h=>{const p=new URLSearchParams(t);h?p.set("search",h):p.delete("search"),p.set("page","1"),a(p)},y=h=>{const p=new URLSearchParams(t);p.set("page",h.toString()),a(p)},M=()=>{i("/board")};return u?e.jsx("div",{className:"container mx-auto px-4 py-8",children:e.jsx(W,{className:"mx-auto"})}):l||!n?e.jsx("div",{className:"container mx-auto px-4 py-8",children:e.jsxs("div",{className:"text-center",children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900 mb-4",children:"오류 발생"}),e.jsx("p",{className:"text-gray-600 mb-6",children:l||"게시판을 찾을 수 없습니다."}),e.jsxs(b,{onClick:M,children:[e.jsx(X,{className:"h-4 w-4 mr-2"}),"게시판 목록으로"]})]})}):e.jsxs("div",{className:"container mx-auto px-4 py-8",children:[e.jsx("div",{className:"mb-6",children:e.jsxs(b,{variant:"ghost",size:"sm",onClick:M,children:[e.jsx(X,{className:"h-4 w-4 mr-2"}),"게시판 목록"]})}),e.jsx(ue,{board:n,posts:m,totalCount:j,currentPage:d,loading:u,searchQuery:g,onSearch:N,onPageChange:y})]})}export{pe as default};
