import{j as e,p as I,q as J,r as Y,s as $,t as K,D as Q,v as R,L as _,C as W,b as X,d as Z,g as ee,a as se,I as k,e as T,w as ae,x as C}from"./index-Da9NyIwh.js";import{r as s,c as le}from"./react-vendor-KiDtdJWs.js";import{L as F}from"./label-Dn8kg9cc.js";import{S as ie}from"./shield-tfT9R3xB.js";import"./ui-vendor-DNtsQh8S.js";const re=J("relative w-full rounded-lg border p-4 [&>svg~*]:pl-7 [&>svg+div]:translate-y-[-3px] [&>svg]:absolute [&>svg]:left-4 [&>svg]:top-4 [&>svg]:text-foreground",{variants:{variant:{default:"bg-background text-foreground",destructive:"border-destructive/50 text-destructive dark:border-destructive [&>svg]:text-destructive"}},defaultVariants:{variant:"default"}}),E=s.forwardRef(({className:o,variant:a,...l},v)=>e.jsxDEV("div",{ref:v,role:"alert",className:I(re({variant:a}),o),...l},void 0,!1,{fileName:"C:/rebuild_e2e/UI_sample/lovable/src/components/ui/alert.tsx",lineNumber:26,columnNumber:3},void 0));E.displayName="Alert";const ne=s.forwardRef(({className:o,...a},l)=>e.jsxDEV("h5",{ref:l,className:I("mb-1 font-medium leading-none tracking-tight",o),...a},void 0,!1,{fileName:"C:/rebuild_e2e/UI_sample/lovable/src/components/ui/alert.tsx",lineNumber:39,columnNumber:3},void 0));ne.displayName="AlertTitle";const D=s.forwardRef(({className:o,...a},l)=>e.jsxDEV("div",{ref:l,className:I("text-sm [&_p]:leading-relaxed",o),...a},void 0,!1,{fileName:"C:/rebuild_e2e/UI_sample/lovable/src/components/ui/alert.tsx",lineNumber:51,columnNumber:3},void 0));D.displayName="AlertDescription";const te={};function be(){const{signIn:o,user:a,loading:l,loginDevBypass:v}=Y(),m=le(),[x,j]=s.useState({email:"",password:""}),[V,L]=s.useState(null),[P,g]=s.useState(null),[h,n]=s.useState(!1),[B,M]=s.useState(!1),[q,f]=s.useState(!1),U=s.useRef(!1),u=s.useRef(!1),p=s.useRef(null),A=$(),H=typeof window<"u"&&/^(localhost|127\.0\.0\.1|0\.0\.0\.0)$/i.test(window.location.hostname),O=typeof import.meta<"u"&&typeof te<"u"&&!0&&"dev".trim().toLowerCase()==="dev",z=K(),d=O||z,N=d&&q;typeof window<"u"&&console.log("dev bypass flags",{supabaseEnv:A,isLocalHost:H,isDevBypass:d}),s.useEffect(()=>{!l&&a&&a.role==="admin"&&m("/admin/dashboard")},[a,l,m]),s.useEffect(()=>{if(console.log("auto-login effect check",{isDevBypass:d,loading:l,hasUser:!!a,autoLoginAttempted:B,supabaseEnv:A}),!d||l||a||U.current)return;let i=!1;console.log("auto-login scheduling"),U.current=!0,M(!0),g(null),n(!0),f(!0),u.current=!0;const r=window.setTimeout(async()=>{var c,y;if(p.current=null,i){console.log("auto-login cancelled before attempt");return}try{console.log("auto login attempt",{email:Q});const{error:t,data:b}=await v();if(console.log("auto login result",{error:(t==null?void 0:t.message)??null,role:((c=b==null?void 0:b.user)==null?void 0:c.role)??null}),i){console.log("auto-login cancelled after sign-in result");return}if(t){g(t.message??"개발 환경 자동 로그인에 실패했습니다. 수동 로그인으로 진행해 주세요."),n(!1),f(!1),u.current=!1,console.warn("auto login error",t);return}const S=(y=b==null?void 0:b.user)==null?void 0:y.role;if(S!=="admin"){g("개발용 계정에 관리자 권한이 없습니다. 수동 로그인으로 진행해 주세요."),n(!1),f(!1),u.current=!1,console.warn("auto login role mismatch",{role:S});return}f(!1),u.current=!1,n(!1),console.log("auto login success, navigating to dashboard"),m("/admin/dashboard",{replace:!0})}catch(t){if(i)return;g("자동 로그인 중 알 수 없는 오류가 발생했습니다. 수동 로그인으로 진행해 주세요."),n(!1),f(!1),u.current=!1,console.error("auto login unexpected error",t)}},R);return p.current=r,()=>{i=!0,p.current!==null&&(window.clearTimeout(p.current),p.current=null,u.current=!1,console.log("auto-login cleanup invoked"))}},[d,l,a,v,m,A]);const G=async i=>{i.preventDefault(),n(!0),L(null),g(null);const{error:r,data:c}=await o(x.email,x.password);if(r){L(r.message),C.error(r.message),n(!1);return}if((c==null?void 0:c.user.role)!=="admin"){L("관리자 권한이 없습니다."),C.error("관리자 권한이 없습니다."),n(!1);return}C.success("관리자 로그인 성공!"),m("/admin/dashboard")},w=V??P;return l?e.jsxDEV("div",{className:"min-h-screen flex items-center justify-center bg-gradient-to-br from-slate-900 to-slate-800",children:e.jsxDEV(_,{className:"h-8 w-8 animate-spin text-white"},void 0,!1,{fileName:"C:/rebuild_e2e/UI_sample/lovable/src/pages/admin/AdminLoginPage.tsx",lineNumber:182,columnNumber:9},this)},void 0,!1,{fileName:"C:/rebuild_e2e/UI_sample/lovable/src/pages/admin/AdminLoginPage.tsx",lineNumber:181,columnNumber:7},this):e.jsxDEV("div",{className:"min-h-screen flex items-center justify-center bg-gradient-to-br from-slate-900 to-slate-800 p-4",children:e.jsxDEV(W,{className:"w-full max-w-md shadow-2xl",children:[e.jsxDEV(X,{className:"space-y-1",children:[e.jsxDEV("div",{className:"flex items-center justify-center mb-4",children:e.jsxDEV("div",{className:"bg-blue-100 p-3 rounded-full",children:e.jsxDEV(ie,{className:"h-8 w-8 text-blue-600"},void 0,!1,{fileName:"C:/rebuild_e2e/UI_sample/lovable/src/pages/admin/AdminLoginPage.tsx",lineNumber:193,columnNumber:15},this)},void 0,!1,{fileName:"C:/rebuild_e2e/UI_sample/lovable/src/pages/admin/AdminLoginPage.tsx",lineNumber:192,columnNumber:13},this)},void 0,!1,{fileName:"C:/rebuild_e2e/UI_sample/lovable/src/pages/admin/AdminLoginPage.tsx",lineNumber:191,columnNumber:11},this),e.jsxDEV(Z,{className:"text-2xl font-bold text-center",children:"관리자 로그인"},void 0,!1,{fileName:"C:/rebuild_e2e/UI_sample/lovable/src/pages/admin/AdminLoginPage.tsx",lineNumber:196,columnNumber:11},this),e.jsxDEV(ee,{className:"text-center",children:"JP Caster 관리 시스템"},void 0,!1,{fileName:"C:/rebuild_e2e/UI_sample/lovable/src/pages/admin/AdminLoginPage.tsx",lineNumber:199,columnNumber:11},this)]},void 0,!0,{fileName:"C:/rebuild_e2e/UI_sample/lovable/src/pages/admin/AdminLoginPage.tsx",lineNumber:190,columnNumber:9},this),e.jsxDEV(se,{children:[d&&e.jsxDEV(E,{className:"mb-4 border-amber-300 bg-amber-50 text-amber-900",children:e.jsxDEV(D,{className:"space-y-1",children:[e.jsxDEV("span",{className:"font-semibold",children:"⚠️ Development Mode - Auto-login enabled"},void 0,!1,{fileName:"C:/rebuild_e2e/UI_sample/lovable/src/pages/admin/AdminLoginPage.tsx",lineNumber:207,columnNumber:17},this),e.jsxDEV("p",{className:"text-sm",children:["현재 `SUPABASE_ENV` 값이 dev로 설정되어 있어 ",R/1e3,"초 후 개발용 관리자 계정으로 자동 로그인합니다. 배포 환경에서는 반드시 dev 값을 제거하여 인증 우회를 비활성화하세요."]},void 0,!0,{fileName:"C:/rebuild_e2e/UI_sample/lovable/src/pages/admin/AdminLoginPage.tsx",lineNumber:208,columnNumber:17},this),N&&!P&&!V&&e.jsxDEV("span",{className:"mt-1 inline-flex items-center text-xs text-amber-700",children:[e.jsxDEV(_,{className:"mr-2 h-3 w-3 animate-spin"},void 0,!1,{fileName:"C:/rebuild_e2e/UI_sample/lovable/src/pages/admin/AdminLoginPage.tsx",lineNumber:214,columnNumber:21},this)," 자동 로그인 진행 중입니다..."]},void 0,!0,{fileName:"C:/rebuild_e2e/UI_sample/lovable/src/pages/admin/AdminLoginPage.tsx",lineNumber:213,columnNumber:19},this)]},void 0,!0,{fileName:"C:/rebuild_e2e/UI_sample/lovable/src/pages/admin/AdminLoginPage.tsx",lineNumber:206,columnNumber:15},this)},void 0,!1,{fileName:"C:/rebuild_e2e/UI_sample/lovable/src/pages/admin/AdminLoginPage.tsx",lineNumber:205,columnNumber:13},this),e.jsxDEV("form",{onSubmit:G,className:"space-y-4",children:[e.jsxDEV("div",{className:"space-y-2",children:[e.jsxDEV(F,{htmlFor:"email",children:"이메일"},void 0,!1,{fileName:"C:/rebuild_e2e/UI_sample/lovable/src/pages/admin/AdminLoginPage.tsx",lineNumber:222,columnNumber:15},this),e.jsxDEV(k,{id:"email",type:"email",value:x.email,onChange:i=>j(r=>({...r,email:i.target.value})),placeholder:"admin@jpcaster.com",required:!0,disabled:h||N,autoComplete:"email"},void 0,!1,{fileName:"C:/rebuild_e2e/UI_sample/lovable/src/pages/admin/AdminLoginPage.tsx",lineNumber:223,columnNumber:15},this)]},void 0,!0,{fileName:"C:/rebuild_e2e/UI_sample/lovable/src/pages/admin/AdminLoginPage.tsx",lineNumber:221,columnNumber:13},this),e.jsxDEV("div",{className:"space-y-2",children:[e.jsxDEV(F,{htmlFor:"password",children:"비밀번호"},void 0,!1,{fileName:"C:/rebuild_e2e/UI_sample/lovable/src/pages/admin/AdminLoginPage.tsx",lineNumber:235,columnNumber:15},this),e.jsxDEV(k,{id:"password",type:"password",value:x.password,onChange:i=>j(r=>({...r,password:i.target.value})),placeholder:"최소 8자 이상",required:!0,minLength:8,disabled:h||N,autoComplete:"current-password"},void 0,!1,{fileName:"C:/rebuild_e2e/UI_sample/lovable/src/pages/admin/AdminLoginPage.tsx",lineNumber:236,columnNumber:15},this)]},void 0,!0,{fileName:"C:/rebuild_e2e/UI_sample/lovable/src/pages/admin/AdminLoginPage.tsx",lineNumber:234,columnNumber:13},this),w&&e.jsxDEV(E,{variant:"destructive",children:e.jsxDEV(D,{children:w},void 0,!1,{fileName:"C:/rebuild_e2e/UI_sample/lovable/src/pages/admin/AdminLoginPage.tsx",lineNumber:250,columnNumber:17},this)},void 0,!1,{fileName:"C:/rebuild_e2e/UI_sample/lovable/src/pages/admin/AdminLoginPage.tsx",lineNumber:249,columnNumber:15},this),e.jsxDEV(T,{type:"submit",className:"w-full",disabled:h||N,children:N?e.jsxDEV(e.Fragment,{children:[e.jsxDEV(_,{className:"mr-2 h-4 w-4 animate-spin"},void 0,!1,{fileName:"C:/rebuild_e2e/UI_sample/lovable/src/pages/admin/AdminLoginPage.tsx",lineNumber:260,columnNumber:19},this),"자동 로그인 대기 중..."]},void 0,!0,{fileName:"C:/rebuild_e2e/UI_sample/lovable/src/pages/admin/AdminLoginPage.tsx",lineNumber:259,columnNumber:17},this):h?e.jsxDEV(e.Fragment,{children:[e.jsxDEV(_,{className:"mr-2 h-4 w-4 animate-spin"},void 0,!1,{fileName:"C:/rebuild_e2e/UI_sample/lovable/src/pages/admin/AdminLoginPage.tsx",lineNumber:265,columnNumber:19},this),"로그인 중..."]},void 0,!0,{fileName:"C:/rebuild_e2e/UI_sample/lovable/src/pages/admin/AdminLoginPage.tsx",lineNumber:264,columnNumber:17},this):"로그인"},void 0,!1,{fileName:"C:/rebuild_e2e/UI_sample/lovable/src/pages/admin/AdminLoginPage.tsx",lineNumber:253,columnNumber:13},this)]},void 0,!0,{fileName:"C:/rebuild_e2e/UI_sample/lovable/src/pages/admin/AdminLoginPage.tsx",lineNumber:220,columnNumber:11},this)]},void 0,!0,{fileName:"C:/rebuild_e2e/UI_sample/lovable/src/pages/admin/AdminLoginPage.tsx",lineNumber:203,columnNumber:9},this),e.jsxDEV(ae,{className:"flex flex-col space-y-2",children:[e.jsxDEV("p",{className:"text-center text-sm text-muted-foreground",children:"비밀번호를 잊으셨나요? 시스템 관리자에게 문의하세요."},void 0,!1,{fileName:"C:/rebuild_e2e/UI_sample/lovable/src/pages/admin/AdminLoginPage.tsx",lineNumber:275,columnNumber:11},this),e.jsxDEV(T,{variant:"ghost",size:"sm",onClick:()=>m("/"),className:"text-sm",children:"메인 페이지로 돌아가기"},void 0,!1,{fileName:"C:/rebuild_e2e/UI_sample/lovable/src/pages/admin/AdminLoginPage.tsx",lineNumber:278,columnNumber:11},this)]},void 0,!0,{fileName:"C:/rebuild_e2e/UI_sample/lovable/src/pages/admin/AdminLoginPage.tsx",lineNumber:274,columnNumber:9},this)]},void 0,!0,{fileName:"C:/rebuild_e2e/UI_sample/lovable/src/pages/admin/AdminLoginPage.tsx",lineNumber:189,columnNumber:7},this)},void 0,!1,{fileName:"C:/rebuild_e2e/UI_sample/lovable/src/pages/admin/AdminLoginPage.tsx",lineNumber:188,columnNumber:5},this)}export{be as default};
