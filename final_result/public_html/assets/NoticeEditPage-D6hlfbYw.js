import{r as I,j as e,L as v,e as d,o as j,C as P,b as V,d as U,a as y,I as C,x as n,y as h}from"./index-DHODk6Hn.js";import{c as S,d as w,r as u}from"./react-vendor-KiDtdJWs.js";import{A as g}from"./AdminLayout-C89rwIaN.js";import{L as N}from"./label-Bo5_Rsky.js";import{T as F}from"./textarea-lNZinO3N.js";import{S as L,a as k,b as A,c as T,d as b}from"./select-BhcOHGaG.js";import{C as q}from"./checkbox-Baa1Z0oH.js";import"./ui-vendor-DNtsQh8S.js";import"./users-CL6e8PB_.js";function Q(){const t=S(),{id:m}=w(),{user:o,loading:p}=I(),[_,f]=u.useState(!0),[l,x]=u.useState(!1),[i,c]=u.useState({title:"",content:"",category:"general",is_pinned:!1});u.useEffect(()=>{(async()=>{if(!m){n.error("유효하지 않은 공지사항 ID입니다."),t("/admin/notices");return}if(!(p||!o)){f(!0);try{const a=(await h.getNotices({search:void 0})).notices.find(D=>D.id===m);if(!a){n.error("공지사항을 찾을 수 없습니다."),t("/admin/notices");return}c({title:a.title,content:a.content,category:a.category,is_pinned:a.is_pinned||a.isPinned||!1})}catch(r){console.error("Failed to fetch notice:",r),n.error("공지사항을 불러오는데 실패했습니다."),t("/admin/notices")}finally{f(!1)}}})()},[m,t,p,o]);const E=async s=>{if(s.preventDefault(),!!m){if(!o){n.error("세션이 만료되었습니다. 다시 로그인해 주세요."),t("/admin/login");return}x(!0);try{await h.updateNotice(m,{...i,isPinned:i.is_pinned}),n.success("공지사항이 수정되었습니다."),t("/admin/notices")}catch(r){console.error("Failed to update notice:",r),n.error(r.message||"공지사항 수정에 실패했습니다.")}finally{x(!1)}}};return p||_?e.jsxDEV(g,{children:e.jsxDEV("div",{className:"flex justify-center items-center min-h-[400px]",children:e.jsxDEV(v,{className:"h-8 w-8 animate-spin text-blue-600"},void 0,!1,{fileName:"/mnt/c/rebuild_e2e/UI_sample/lovable/src/pages/admin/notices/NoticeEditPage.tsx",lineNumber:106,columnNumber:11},this)},void 0,!1,{fileName:"/mnt/c/rebuild_e2e/UI_sample/lovable/src/pages/admin/notices/NoticeEditPage.tsx",lineNumber:105,columnNumber:9},this)},void 0,!1,{fileName:"/mnt/c/rebuild_e2e/UI_sample/lovable/src/pages/admin/notices/NoticeEditPage.tsx",lineNumber:104,columnNumber:7},this):o?e.jsxDEV(g,{children:e.jsxDEV("div",{className:"space-y-6 max-w-4xl",children:[e.jsxDEV("div",{className:"flex items-center gap-4",children:[e.jsxDEV(d,{variant:"ghost",size:"icon",onClick:()=>t("/admin/notices"),children:e.jsxDEV(j,{className:"h-5 w-5"},void 0,!1,{fileName:"/mnt/c/rebuild_e2e/UI_sample/lovable/src/pages/admin/notices/NoticeEditPage.tsx",lineNumber:134,columnNumber:13},this)},void 0,!1,{fileName:"/mnt/c/rebuild_e2e/UI_sample/lovable/src/pages/admin/notices/NoticeEditPage.tsx",lineNumber:129,columnNumber:11},this),e.jsxDEV("div",{children:[e.jsxDEV("h1",{className:"text-3xl font-bold text-slate-900",children:"공지 수정"},void 0,!1,{fileName:"/mnt/c/rebuild_e2e/UI_sample/lovable/src/pages/admin/notices/NoticeEditPage.tsx",lineNumber:137,columnNumber:13},this),e.jsxDEV("p",{className:"text-slate-600 mt-1",children:"공지사항을 수정합니다."},void 0,!1,{fileName:"/mnt/c/rebuild_e2e/UI_sample/lovable/src/pages/admin/notices/NoticeEditPage.tsx",lineNumber:138,columnNumber:13},this)]},void 0,!0,{fileName:"/mnt/c/rebuild_e2e/UI_sample/lovable/src/pages/admin/notices/NoticeEditPage.tsx",lineNumber:136,columnNumber:11},this)]},void 0,!0,{fileName:"/mnt/c/rebuild_e2e/UI_sample/lovable/src/pages/admin/notices/NoticeEditPage.tsx",lineNumber:128,columnNumber:9},this),e.jsxDEV(P,{children:[e.jsxDEV(V,{children:e.jsxDEV(U,{children:"공지사항 정보"},void 0,!1,{fileName:"/mnt/c/rebuild_e2e/UI_sample/lovable/src/pages/admin/notices/NoticeEditPage.tsx",lineNumber:145,columnNumber:13},this)},void 0,!1,{fileName:"/mnt/c/rebuild_e2e/UI_sample/lovable/src/pages/admin/notices/NoticeEditPage.tsx",lineNumber:144,columnNumber:11},this),e.jsxDEV(y,{children:e.jsxDEV("form",{onSubmit:E,className:"space-y-6",children:[e.jsxDEV("div",{className:"space-y-2",children:[e.jsxDEV(N,{htmlFor:"title",children:"제목 *"},void 0,!1,{fileName:"/mnt/c/rebuild_e2e/UI_sample/lovable/src/pages/admin/notices/NoticeEditPage.tsx",lineNumber:151,columnNumber:17},this),e.jsxDEV(C,{id:"title",value:i.title,onChange:s=>c({...i,title:s.target.value}),placeholder:"공지사항 제목을 입력하세요",required:!0,disabled:l},void 0,!1,{fileName:"/mnt/c/rebuild_e2e/UI_sample/lovable/src/pages/admin/notices/NoticeEditPage.tsx",lineNumber:152,columnNumber:17},this)]},void 0,!0,{fileName:"/mnt/c/rebuild_e2e/UI_sample/lovable/src/pages/admin/notices/NoticeEditPage.tsx",lineNumber:150,columnNumber:15},this),e.jsxDEV("div",{className:"space-y-2",children:[e.jsxDEV(N,{htmlFor:"category",children:"카테고리 *"},void 0,!1,{fileName:"/mnt/c/rebuild_e2e/UI_sample/lovable/src/pages/admin/notices/NoticeEditPage.tsx",lineNumber:164,columnNumber:17},this),e.jsxDEV(L,{value:i.category,onValueChange:s=>c({...i,category:s}),disabled:l,children:[e.jsxDEV(k,{children:e.jsxDEV(A,{},void 0,!1,{fileName:"/mnt/c/rebuild_e2e/UI_sample/lovable/src/pages/admin/notices/NoticeEditPage.tsx",lineNumber:171,columnNumber:21},this)},void 0,!1,{fileName:"/mnt/c/rebuild_e2e/UI_sample/lovable/src/pages/admin/notices/NoticeEditPage.tsx",lineNumber:170,columnNumber:19},this),e.jsxDEV(T,{children:[e.jsxDEV(b,{value:"general",children:"일반"},void 0,!1,{fileName:"/mnt/c/rebuild_e2e/UI_sample/lovable/src/pages/admin/notices/NoticeEditPage.tsx",lineNumber:174,columnNumber:21},this),e.jsxDEV(b,{value:"공지",children:"공지"},void 0,!1,{fileName:"/mnt/c/rebuild_e2e/UI_sample/lovable/src/pages/admin/notices/NoticeEditPage.tsx",lineNumber:175,columnNumber:21},this),e.jsxDEV(b,{value:"이벤트",children:"이벤트"},void 0,!1,{fileName:"/mnt/c/rebuild_e2e/UI_sample/lovable/src/pages/admin/notices/NoticeEditPage.tsx",lineNumber:176,columnNumber:21},this),e.jsxDEV(b,{value:"업데이트",children:"업데이트"},void 0,!1,{fileName:"/mnt/c/rebuild_e2e/UI_sample/lovable/src/pages/admin/notices/NoticeEditPage.tsx",lineNumber:177,columnNumber:21},this)]},void 0,!0,{fileName:"/mnt/c/rebuild_e2e/UI_sample/lovable/src/pages/admin/notices/NoticeEditPage.tsx",lineNumber:173,columnNumber:19},this)]},void 0,!0,{fileName:"/mnt/c/rebuild_e2e/UI_sample/lovable/src/pages/admin/notices/NoticeEditPage.tsx",lineNumber:165,columnNumber:17},this)]},void 0,!0,{fileName:"/mnt/c/rebuild_e2e/UI_sample/lovable/src/pages/admin/notices/NoticeEditPage.tsx",lineNumber:163,columnNumber:15},this),e.jsxDEV("div",{className:"space-y-2",children:[e.jsxDEV(N,{htmlFor:"content",children:"내용 *"},void 0,!1,{fileName:"/mnt/c/rebuild_e2e/UI_sample/lovable/src/pages/admin/notices/NoticeEditPage.tsx",lineNumber:184,columnNumber:17},this),e.jsxDEV(F,{id:"content",value:i.content,onChange:s=>c({...i,content:s.target.value}),placeholder:"공지사항 내용을 입력하세요",rows:12,required:!0,disabled:l,className:"font-mono text-sm"},void 0,!1,{fileName:"/mnt/c/rebuild_e2e/UI_sample/lovable/src/pages/admin/notices/NoticeEditPage.tsx",lineNumber:185,columnNumber:17},this),e.jsxDEV("p",{className:"text-sm text-muted-foreground",children:"* 마크다운 형식을 지원합니다."},void 0,!1,{fileName:"/mnt/c/rebuild_e2e/UI_sample/lovable/src/pages/admin/notices/NoticeEditPage.tsx",lineNumber:195,columnNumber:17},this)]},void 0,!0,{fileName:"/mnt/c/rebuild_e2e/UI_sample/lovable/src/pages/admin/notices/NoticeEditPage.tsx",lineNumber:183,columnNumber:15},this),e.jsxDEV("div",{className:"flex items-center space-x-2",children:[e.jsxDEV(q,{id:"is_pinned",checked:i.is_pinned,onCheckedChange:s=>c({...i,is_pinned:s===!0}),disabled:l},void 0,!1,{fileName:"/mnt/c/rebuild_e2e/UI_sample/lovable/src/pages/admin/notices/NoticeEditPage.tsx",lineNumber:202,columnNumber:17},this),e.jsxDEV(N,{htmlFor:"is_pinned",className:"cursor-pointer",children:"상단 고정"},void 0,!1,{fileName:"/mnt/c/rebuild_e2e/UI_sample/lovable/src/pages/admin/notices/NoticeEditPage.tsx",lineNumber:210,columnNumber:17},this)]},void 0,!0,{fileName:"/mnt/c/rebuild_e2e/UI_sample/lovable/src/pages/admin/notices/NoticeEditPage.tsx",lineNumber:201,columnNumber:15},this),e.jsxDEV("div",{className:"flex gap-4 pt-4 border-t",children:[e.jsxDEV(d,{type:"button",variant:"outline",onClick:()=>t("/admin/notices"),disabled:l,children:"취소"},void 0,!1,{fileName:"/mnt/c/rebuild_e2e/UI_sample/lovable/src/pages/admin/notices/NoticeEditPage.tsx",lineNumber:217,columnNumber:17},this),e.jsxDEV(d,{type:"submit",disabled:l,children:l?e.jsxDEV(e.Fragment,{children:[e.jsxDEV(v,{className:"mr-2 h-4 w-4 animate-spin"},void 0,!1,{fileName:"/mnt/c/rebuild_e2e/UI_sample/lovable/src/pages/admin/notices/NoticeEditPage.tsx",lineNumber:228,columnNumber:23},this),"수정 중..."]},void 0,!0,{fileName:"/mnt/c/rebuild_e2e/UI_sample/lovable/src/pages/admin/notices/NoticeEditPage.tsx",lineNumber:227,columnNumber:21},this):"수정 저장"},void 0,!1,{fileName:"/mnt/c/rebuild_e2e/UI_sample/lovable/src/pages/admin/notices/NoticeEditPage.tsx",lineNumber:225,columnNumber:17},this)]},void 0,!0,{fileName:"/mnt/c/rebuild_e2e/UI_sample/lovable/src/pages/admin/notices/NoticeEditPage.tsx",lineNumber:216,columnNumber:15},this)]},void 0,!0,{fileName:"/mnt/c/rebuild_e2e/UI_sample/lovable/src/pages/admin/notices/NoticeEditPage.tsx",lineNumber:148,columnNumber:13},this)},void 0,!1,{fileName:"/mnt/c/rebuild_e2e/UI_sample/lovable/src/pages/admin/notices/NoticeEditPage.tsx",lineNumber:147,columnNumber:11},this)]},void 0,!0,{fileName:"/mnt/c/rebuild_e2e/UI_sample/lovable/src/pages/admin/notices/NoticeEditPage.tsx",lineNumber:143,columnNumber:9},this)]},void 0,!0,{fileName:"/mnt/c/rebuild_e2e/UI_sample/lovable/src/pages/admin/notices/NoticeEditPage.tsx",lineNumber:126,columnNumber:7},this)},void 0,!1,{fileName:"/mnt/c/rebuild_e2e/UI_sample/lovable/src/pages/admin/notices/NoticeEditPage.tsx",lineNumber:125,columnNumber:5},this):e.jsxDEV(g,{children:e.jsxDEV("div",{className:"flex flex-col items-center justify-center min-h-[400px] space-y-4",children:[e.jsxDEV("h2",{className:"text-xl font-semibold",children:"세션이 만료되었습니다."},void 0,!1,{fileName:"/mnt/c/rebuild_e2e/UI_sample/lovable/src/pages/admin/notices/NoticeEditPage.tsx",lineNumber:116,columnNumber:11},this),e.jsxDEV("p",{className:"text-muted-foreground",children:"다시 로그인한 뒤 공지사항을 수정해 주세요."},void 0,!1,{fileName:"/mnt/c/rebuild_e2e/UI_sample/lovable/src/pages/admin/notices/NoticeEditPage.tsx",lineNumber:117,columnNumber:11},this),e.jsxDEV(d,{onClick:()=>t("/admin/login"),children:"로그인 페이지로 이동"},void 0,!1,{fileName:"/mnt/c/rebuild_e2e/UI_sample/lovable/src/pages/admin/notices/NoticeEditPage.tsx",lineNumber:118,columnNumber:11},this)]},void 0,!0,{fileName:"/mnt/c/rebuild_e2e/UI_sample/lovable/src/pages/admin/notices/NoticeEditPage.tsx",lineNumber:115,columnNumber:9},this)},void 0,!1,{fileName:"/mnt/c/rebuild_e2e/UI_sample/lovable/src/pages/admin/notices/NoticeEditPage.tsx",lineNumber:114,columnNumber:7},this)}export{Q as default};
